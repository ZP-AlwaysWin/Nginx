# Nginx正向代理与反向代理的区别

## 一、介绍
>实践中客户端无法直接跟服务端发起请求的时候，我们就需要代理服务。代理可以实现客户端与服务端之间的通信,我们的Nginx也可以实现相应的代理服务。代理分为正向代理和反向代理,此文就来演示一下Nginx配置正向代理和反向代理的场景。

## 二、正向代理

正向代理类似一个跳板机，代理访问外部资源。
<div align="center">
<img src="https://github.com/ZP-AlwaysWin/Nginx/blob/master/nginx-photos/%E6%AD%A3%E5%90%91%E4%BB%A3%E7%90%86%E8%B7%B3%E6%9D%BF%E6%9C%BA%E5%9B%BE.png" />
</div>


**举个例子：**

  拿借钱打个比方，A想向C借钱，但是C不认识A所以不借给他，然后A就通过B向C借钱，B借到钱之后再转交给A，在这个过程中B就扮演了一个正向代理的角色，这个过程中，真正借钱的人是谁，C是不知道的

  我们常说的代理也就是指正向代理，正向代理的过程，它隐藏了真实的请求客户端，服务端不知道真实的客户端是谁，客户端请求的服务都被代理服务器代替来请求，科学上网工具 Shadowsocks 扮演的就是典型的正向代理角色。


### 正向代理的用途：
（1）访问原来无法访问的资源，如google

（2） 可以做缓存，加速访问资源

（3）对客户端访问授权，上网进行认证

（4）代理可以记录用户访问记录（上网行为管理），对外隐藏用户信息




## 三、反向代理
  
  初次接触方向代理的感觉是，客户端是无感知代理的存在的，反向代理对外都是透明的，访问者者并不知道自己访问的是一个代理。因为客户端不需要任何配置就可以访问。

  反向代理（Reverse Proxy）实际运行方式是指以代理服务器来接受internet上的连接请求，然后将请求转发给内部网络上的服务器，并将从服务器上得到的结果返回给internet上请求连接的客户端，此时代理服务器对外就表现为一个服务器。
 

**举个例子：**
还用借钱的例子，A想向C借钱，然后C借给他了，但是实际上这个钱可能C向B借的~至于钱到底是谁的，A是不知道的~

这里的C扮演着一个反向代理的角色，客户不知道真正提供服务的人是谁。

  反向代理隐藏了真实的服务端，当我们访问 www.baidu.com 的时候，背后可能有成千上万台服务器为我们服务，但具体是哪一台，你不知道，也不需要知道，你只需要知道反向代理服务器是谁就好了。www.baidu.com 就是我们的反向代理服务器，反向代理服务器会帮我们把请求转发到提供真实服务的服务器那里去。Nginx就是性能非常好的反向代理服务器，它可以用来做负载均衡。

### 反向代理的用途：

（1）保证内网的安全，可以使用反向代理提供WAF功能，阻止web攻击

大型网站，通常将反向代理作为公网访问地址，Web服务器是内网。
<div align="center">
<img src="https://github.com/ZP-AlwaysWin/Nginx/blob/master/nginx-photos/%E5%8F%8D%E5%90%91%E4%BB%A3%E7%90%86%E9%98%B2%E6%94%BB%E5%87%BB%E5%9B%BE.png" />
</div>

（2）负载均衡，通过反向代理服务器来优化网站的负载
<div align="center">
<img src="https://github.com/ZP-AlwaysWin/Nginx/blob/master/nginx-photos/%E5%8F%8D%E5%90%91%E4%BB%A3%E7%90%86%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1%E5%9B%BE.png" />
</div>

## 四、正反向代理的直观区别
以下面网上的两张图片直观地表示一下二者的区别
<div align="center">
<img src="https://github.com/ZP-AlwaysWin/Nginx/blob/master/nginx-photos/%E6%AD%A3%E5%8F%8D%E5%90%91%E4%BB%A3%E7%90%86%E7%9A%84%E6%89%8B%E7%BB%98%E5%9B%BE.png" />
</div>

<div align="center">
<img src="https://github.com/ZP-AlwaysWin/Nginx/blob/master/nginx-photos/%E6%AD%A3%E5%8F%8D%E5%90%91%E4%BB%A3%E7%90%86%E7%9A%84%E7%BD%91%E7%8A%B6%E5%9B%BE.png" />
</div>

## 五、总结

由上的打比方和演示例子可以体会到正向代理与反向代理的区别。正向代理和反向代理的区别上边也说过在于代理的对象不一样,正向代理的代理对象是客户端,反向代理的代理对象是服务端。

**最后一句话总结此文就是：**

代理服务器站在客户端那边就是正向代理，

代理服务器站在原始服务器那边就是反向代理,

Nginx通过proxy_pass可以设置代理服务。
